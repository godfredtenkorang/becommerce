{% extends 'store/base.html' %}
{% load static %}
{% load mathfilters %}
{% block content %}



<div class="checkout-form-containers">
    <h3> Complete your order
    </h3>
    <p>Please enter in the relevant information below.

    </p>

    <div class="checkoutContainer">

        <form method="POST">
            {% csrf_token %}
            <div class="input-container">
                <div class="input">
                    <label for="">Full Name</label> <br>
                    <input type="text" id="full_name" name="full_name" value="{{ shipping.full_name }}" required>
                </div>
                <div class="input">
                    <label for="">Email</label> <br>
                    <input type="email" id="email" name="email" value="{{ shipping.email }}" required>
                </div>

            </div>
            <div class="input">
                <label for="">Address </label> <br>
                <input type="text" placeholder="1234 Main street" id="address" name="address"
                    value="{{ shipping.address }}" required>
            </div>

            <div class="input">
                <label for="">Phone</label> <br>
                <input type="text" placeholder="+233 558156844" id="phone_number" name="phone_number"
                    value="{{ shipping.phone_number }}" required>
            </div>
            <div class="input">
                <label for="">Country</label> <br>
                <input type="text" placeholder="Ghana" id="country" name="country" value="{{ shipping.country }}"
                    required>
            </div>

            <div class="input-container">
                <div class="input">
                    <label for="">City</label> <br>
                    <input type="text" placeholder="Accra" id="city" name="city" value="{{ shipping.city }}" required>
                </div>
                <div class="input">
                    <label for="">state (optional) </label> <br>
                    <input type="text" name="state" id="state" value="{{ shipping.state }}">
                </div>
                <div class="input">
                    <label for="">Zip (optional)</label>
                    <input type="text" name="zipcode" id="zipcode" value="{{ shipping.zipcode }}">
                </div>


            </div>
            <button type="submit">Pay
                Now</button>
        </form>

        <div class="total-fee">
            <p>Your cart</p>

            {% for item in cart %}
            {% with product=item.product %}
            <ul class="list-group mb-3">
                <li class="list-group-item d-flex justify-content-between lh-condensed">
                    <div>
                        <h6 class="my-0">{{ product.title }}</h6>
                        <!-- <small class="text-muted">{{ product.description }}</small> -->
                    </div>
                    <span class="text-muted">GH¢{{ product.final_price|mul:item.qty }}</span>
                </li>
            </ul>
            {% endwith %}
            {% endfor %}

            <ul class="list-group mb-3">
                <li class="list-group-item d-flex justify-content-between">
                    <span>Subtotal</span>
                    <span class="text-muted">GH¢{{ cart.get_total }}</span>
                </li>
            </ul>
            <ul class="list-group mb-3">
                <li class="list-group-item d-flex justify-content-between">
                    <span>Shipping Fee</span>
                    <span class="text-muted">GH¢20.00</span>
                </li>
            </ul>

            <ul class="list-group mb-3">
                <li class="list-group-item d-flex justify-content-between">
                    <span>Total</span>
                    <strong>GH¢{{ cart.get_all_total }}</strong>
                </li>
            </ul>

            
        </div>


    </div>
</div>


</div>

<script>

    $.ajax({
            type: 'POST',
            url: '{% url "complete-order" %}',
            data: {
                full_name: $('#full_name').val(),
                email: $('#email').val(),
                address: $('#address').val(),
                phone_number: $('#phone_number').val(),
                country: $('#country').val(),
                city: $('#city').val(),
                state: $('#state').val(),
                zipcode: $('#zipcode').val(),
                csrfmiddlewaretoken: "{{csrf_token}}",
                action: 'post'
            },

        });


</script>

{% endblock %}